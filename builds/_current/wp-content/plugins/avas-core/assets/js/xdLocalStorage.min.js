"use strict";window.XdUtils=window.XdUtils||{extend:function(b,d){var a,c=d||{};for(a in b)b.hasOwnProperty(a)&&(c[a]=b[a]);return c}},window.bdtLiveCopyLocalStorage=window.bdtLiveCopyLocalStorage||function(){var a,b="cross-domain-local-message",c={iframeId:"ep-live-copy-cross-domain-iframe",iframeUrl:void 0,initCallback:function(){}},d=-1,e={},f=!1,g=!0;function h(f){var a,d;try{a=JSON.parse(f.data)}catch(h){}a&&a.namespace===b&&("iframe-ready"===a.id?(g=!0,c.initCallback()):e[(d=a).id]&&(e[d.id](d),delete e[d.id]))}function i(c,f,g,h){e[++d]=h,a.contentWindow.postMessage(JSON.stringify({namespace:b,id:d,action:c,key:f,value:g}),"*")}function j(d){c=XdUtils.extend(d,c);var b=document.createElement("div");window.addEventListener?window.addEventListener("message",h,!1):window.attachEvent("onmessage",h),b.innerHTML='<iframe id="'+c.iframeId+'" src="'+c.iframeUrl+'" style="display: none;"></iframe>',document.body.appendChild(b),a=document.getElementById(c.iframeId)}function k(){return f?!!g||(console.log("You must wait for iframe ready message before using the api."),!1):(console.log("You must call bdtLiveCopyLocalStorage.init() before using it."),!1)}function l(){return"complete"===document.readyState}return{init:function(a){if(!a.iframeUrl)throw"You must specify iframeUrl";if(f){console.log("bdtLiveCopyLocalStorage was already initialized!");return}f=!0,l()?j(a):document.addEventListener?document.addEventListener("readystatechange",function(){l()&&j(a)}):document.attachEvent("readystatechange",function(){l()&&j(a)})},setItem:function(a,b,c){k()&&i("set",a,b,c)},getItem:function(a,b){k()&&i("get",a,null,b)},removeItem:function(a,b){k()&&i("remove",a,null,b)},key:function(a,b){k()&&i("key",a,null,b)},getSize:function(a){k()&&i("size",null,null,a)},getLength:function(a){k()&&i("length",null,null,a)},clear:function(a){k()&&i("clear",null,null,a)},wasInit:function(){return f}}}()